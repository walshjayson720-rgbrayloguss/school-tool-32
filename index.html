<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>School Tool Hub</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#0f172a;
  --box:#020617;
  --text:white;
  --btn:#2563eb;
}
.light{
  --bg:#f1f5f9;
  --box:#ffffff;
  --text:#020617;
}

body{
  margin:0;
  font-family:Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}

header{
  background:var(--box);
  padding:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.tabs{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
}

.tab{
  background:transparent;
  color:var(--text);
  border:1px solid var(--btn);
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}
.tab.active{
  background:var(--btn);
  color:white;
}

button{
  background:var(--btn);
  color:white;
  border:none;
  padding:8px 12px;
  border-radius:6px;
  cursor:pointer;
}

.container{
  padding:20px;
}

.box{
  background:var(--box);
  padding:15px;
  border-radius:10px;
  max-width:900px;
  margin:auto;
}

input, textarea, select{
  width:100%;
  padding:8px;
  margin-top:6px;
  border-radius:6px;
  border:none;
}

.hidden{display:none;}

.item{
  padding:6px;
  border-bottom:1px solid rgba(255,255,255,0.15);
}

.progress{
  background:#334155;
  border-radius:10px;
  overflow:hidden;
  margin-top:10px;
}
.progress div{
  height:12px;
  background:#22c55e;
  width:0%;
}
</style>
</head>
<body>

<header>
  <div class="tabs">
    <button class="tab active" onclick="openTab('homework',this)">Homework</button>
    <button class="tab" onclick="openTab('notes',this)">Notes</button>
    <button class="tab" onclick="openTab('essay',this)">Essay</button>
    <button class="tab" onclick="openTab('calc',this)">Calculator</button>
    <button class="tab" onclick="openTab('grammar',this)">Grammar</button>
    <button class="tab" onclick="openTab('ai',this)">AI</button>
  </div>
  <div>
    <button id="themeBtn">Theme</button>
    <button id="blankBtn">about:blank</button>
  </div>
</header>

<div class="container">

<!-- HOMEWORK -->
<div id="homework" class="box">
  <h3>Homework Planner</h3>
  <input id="hwTitle" placeholder="Assignment">
  <input id="hwClass" placeholder="Class">
  <input id="hwDate" type="date">
  <button onclick="addHomework()">Add</button>
  <div class="progress"><div id="hwProgress"></div></div>
  <div id="hwList"></div>
</div>

<!-- NOTES -->
<div id="notes" class="box hidden">
  <h3>Notes Organizer</h3>
  <input id="noteClass" placeholder="Class">
  <textarea id="noteText" rows="4"></textarea>
  <button onclick="saveNote()">Save</button>
  <input id="searchNotes" placeholder="Search" oninput="renderNotes()">
  <div id="noteList"></div>
</div>

<!-- ESSAY -->
<div id="essay" class="box hidden">
  <h3>Essay Outline Generator</h3>
  <input id="essayTopic" placeholder="Topic">
  <select id="essayLength">
    <option>Short (3 paragraphs)</option>
    <option>Medium (5 paragraphs)</option>
    <option>Long (7 paragraphs)</option>
  </select>
  <button onclick="generateOutline()">Generate</button>
  <div id="essayOutput"></div>
</div>

<!-- CALCULATOR -->
<div id="calc" class="box hidden">
  <h3>Calculator</h3>
  <input id="calcInput" placeholder="Example: 8*(5+2)">
  <button onclick="calculate()">Calculate</button>
  <div id="calcResult"></div>
</div>

<!-- GRAMMAR -->
<div id="grammar" class="box hidden">
  <h3>Grammar Corrector</h3>
  <textarea id="grammarInput" rows="5"></textarea>
  <button onclick="fixGrammar()">Fix Grammar</button>
  <div id="grammarOutput"></div>
</div>

<!-- AI -->
<div id="ai" class="box hidden">
  <h3>AI Assistant</h3>
  <input id="aiInput" placeholder="Ask a question">
  <button onclick="askAI()">Ask</button>
  <div id="aiOutput"></div>
</div>

</div>

<script>
// ========== ABOUT:BLANK ==========
blankBtn.onclick = () => {
  const w = window.open("about:blank");
  w.document.write(`<iframe src="${location.href}" style="border:none;width:100vw;height:100vh;"></iframe>`);
};

// ========== THEME ==========
if(localStorage.theme==="light")document.body.classList.add("light");
themeBtn.onclick=()=>{
  document.body.classList.toggle("light");
  localStorage.theme=document.body.classList.contains("light")?"light":"dark";
};

// ========== TABS ==========
function openTab(id,btn){
  document.querySelectorAll(".box").forEach(b=>b.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  btn.classList.add("active");
}

// ========== HOMEWORK ==========
function addHomework(){
  const hw=JSON.parse(localStorage.hw||"[]");
  hw.push({title:hwTitle.value,class:hwClass.value,date:hwDate.value,done:false});
  localStorage.hw=JSON.stringify(hw);
  renderHomework();
}
function toggleDone(i){
  const hw=JSON.parse(localStorage.hw||"[]");
  hw[i].done=!hw[i].done;
  localStorage.hw=JSON.stringify(hw);
  renderHomework();
}
function renderHomework(){
  const hw=JSON.parse(localStorage.hw||"[]");
  hwList.innerHTML=hw.map((h,i)=>`
    <div class="item">
      <input type="checkbox" ${h.done?"checked":""} onclick="toggleDone(${i})">
      <b>${h.title}</b> (${h.class}) – ${h.date}
    </div>`).join("");
  hwProgress.style.width=(hw.length?hw.filter(x=>x.done).length/hw.length*100:0)+"%";
}
renderHomework();

// ========== NOTES ==========
function saveNote(){
  const n=JSON.parse(localStorage.notes||"[]");
  n.push({class:noteClass.value,text:noteText.value});
  localStorage.notes=JSON.stringify(n);
  noteText.value="";
  renderNotes();
}
function renderNotes(){
  const q=searchNotes.value.toLowerCase();
  const n=JSON.parse(localStorage.notes||"[]");
  noteList.innerHTML=n
    .filter(x=>x.text.toLowerCase().includes(q)||x.class.toLowerCase().includes(q))
    .map(x=>`<div class="item"><b>${x.class}</b><br>${x.text}</div>`).join("");
}
renderNotes();

// ========== ESSAY ==========
function generateOutline(){
  const t=essayTopic.value;
  const l=essayLength.value;
  let b=l.includes("3")?1:l.includes("5")?3:5;
  let out=`<b>Introduction</b>: Thesis about "${t}"<br><br>`;
  for(let i=1;i<=b;i++) out+=`• Body Paragraph ${i}: Claim, evidence, explanation<br>`;
  out+=`<br><b>Conclusion</b>: Restate thesis`;
  essayOutput.innerHTML=out;
}

// ========== CALCULATOR ==========
function calculate(){
  try{calcResult.innerText="Result: "+eval(calcInput.value);}
  catch{calcResult.innerText="Invalid expression";}
}

// ========== GRAMMAR (WORKING) ==========
function fixGrammar(){
  let t=grammarInput.value.trim().replace(/\s+/g," ");
  const typos={
    "teh":"the","dont":"don't","cant":"can't","im":"I'm",
    "alot":"a lot","becuase":"because","recieve":"receive"
  };
  Object.keys(typos).forEach(k=>{
    t=t.replace(new RegExp(`\\b${k}\\b`,"gi"),typos[k]);
  });
  t=t.toLowerCase().replace(/(^\w|[.!?]\s+\w)/g,m=>m.toUpperCase());
  t=t.replace(/\s+(and|but|so|because|however)\s+/gi,", $1 ");
  if(!/[.!?]$/.test(t)) t+=".";
  grammarOutput.innerText=t;
}

// ========== AI (REAL + MEMORY + TYPING) ==========
let aiMemory=JSON.parse(sessionStorage.aiMemory||"[]");

function askAI(){
  const q=aiInput.value.trim();
  if(!q)return;
  aiMemory.push({role:"user",text:q});
  aiMemory=aiMemory.slice(-6);
  sessionStorage.aiMemory=JSON.stringify(aiMemory);
  const r=generateAIResponse(q.toLowerCase());
  aiMemory.push({role:"ai",text:r});
  sessionStorage.aiMemory=JSON.stringify(aiMemory);
  typeAI(aiOutput,r);
}

function generateAIResponse(q){
  const ctx=aiMemory.map(x=>x.text).join(" ");
  if(q.includes("hello")||q.includes("hi"))return"Hello. How can I help you today?";
  if(q.includes("homework"))return"Use the Homework tab to track assignments and progress.";
  if(q.includes("essay"))return"The Essay tab creates structured outlines for writing.";
  if(q.includes("grammar"))return"Use the Grammar tab to fix typos, commas, and punctuation.";
  if(q.includes("study"))return"Study in focused sessions with breaks and review notes daily.";
  if(ctx.includes("essay")&&q.includes("help"))return"Do you want help with an introduction or body paragraph?";
  return"Ask me about homework, essays, grammar, or studying.";
}

function typeAI(el,text){
  el.innerText="";
  let i=0;
  const int=setInterval(()=>{
    el.innerText+=text[i++];
    if(i>=text.length)clearInterval(int);
  },18);
}
</script>

</body>
</html>
